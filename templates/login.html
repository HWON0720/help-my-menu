<!-- 로그인 및 회원가입 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- File Upload -->
    <script src="https://cdn.jsdelivr.net/npm/bs-custom-file-input/dist/bs-custom-file-input.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- Google Font: Jua -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">

    <!-- google Font: Noto -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300&display=swap" rel="stylesheet">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
            integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
            integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css"> <!-- jQuery UI -->
    <script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <!-- 'Help My Menu' Javascript, CSS -->
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='helpmymenu.css') }}">
    <script type="text/javascript" src="{{ url_for('static', filename='helpmymenu.js') }}"></script> -->

    <title>우당탕탕 | 헤얿 마이 메뉴</title>

    <!--Bootsrap 4 CDN-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <!--Fontawesome CDN-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css"
          integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!--Custom styles-->
    <link rel="stylesheet" type="text/css" href="/static/helpmymenu.css">

    <style>
        @import url('https://fonts.googleapis.com/css?family=Numans');

        html, body {
            background-image: url('/static/helpmymenu.png');
            background-size: 1400px;
            background-repeat: no-repeat;
            height: 100%;
            font-family: 'Numans', sans-serif;
        }

        .container {
            margin: 50px auto;
            height: 100%;
            align-content: center;
        }

        .login-card {
            height: 300px;
            margin-top: auto;
            margin-bottom: auto;
            width: 400px;
            background-color: rgba(0, 0, 0, 0.3)
        }

        .signup-card {
            height: 370px;
            margin-top: auto;
            margin-bottom: auto;
            width: 400px;
            background-color: rgba(0, 0, 0, 0.3)
        }

        .social_icon span {
            font-size: 60px;
            margin-left: 10px;
            color: #fc6c3f;
        }

        .social_icon span:hover {
            color: white;
            cursor: pointer;
        }

        .card-header h3 {
            color: white;
        }

        .social_icon {
            position: absolute;
            right: 20px;
            top: -45px;
        }

        .input-group-prepend span {
            width: 40px;
            background-color: #fc6c3f;
            color: black;
            border: 0
        }

        .remember {
            color: white;
        }

        .remember input {
            width: 20px;
            height: 20px;
            margin-left: 15px;
            margin-right: 5px;
        }

        .login_btn {
            color: black;
            background-color: #fc6c3f;
            width: 100px;
        }

        .login_btn:hover {
            color: black;
            background-color: white;
        }

        .links {
            color: white;
        }

        .links a {
            margin-left: 4px;
        }

        .is-hidden {
            display: none !important;
        }

    </style>
    <script>
        function toggleSignUpAndIn() {
            $("#login").toggleClass("is-hidden")
            $("#signup").toggleClass("is-hidden")
        }

        let check = []

        function signUp() {
            let username = $("#username").val();
            let email = $("#email").val();
            let password = $("#password").val();
            let repassword = $("#repassword").val();
            console.log(username,email, password, repassword)

            if (username == "") {
                alert("닉네임을 입력해주세요.\n닉네임은 4-10자의 영문, 숫자, 일부 특수문자(._-)만 입력 가능합니다.")
                return;
            } else if (username.length < 4 || username.length > 10 || !isNickname(username)) {
                alert("닉네임을 확인해주세요.\n닉네임은 4-10자의 영문, 숫자, 일부 특수문자(._-)만 입력 가능합니다.")
                return;
            }
            
            if (email == "") {
                alert("이메일을 입력해주세요.")
                return;
            } else if (!isEmail(email)) {
                alert("이메일이 유효하지 않습니다.\n올바른 이메일인지 확인해주세요.")
                return;
            } 

            checkDupNicknameAndEmail();

            if (password == "") {
                alert("비밀번호를 설정해주세요.")
                return;
            } else if (!isPassword(password)) {
                alert("비밀번호의 형식을 확인해주세요.\n비밀번호는 8-20자의 영문과 숫자 필수 포함, 특수문자(!@#$%^&*)만 사용 가능합니다.")
                return;
            }

            if (repassword == "") {
                alert("비밀번호를 설정해주세요.")
                return;
            } else if (repassword != password) {
                alert("비밀번호가 일치하지 않습니다.")
                return;
            }

            if (check[0] == 1) {
                alert("이미 존재하는 닉네임입니다.")
                return;
            } else if (check[1] == 1) {
                alert("이미 존재하는 이메일입니다.")
                return;
            }

            $.ajax({
                type: "POST",
                url: "/sign_up/save",
                data: {
                    username_give: username,
                    email_give: email,
                    password_give: password
                },
                success: function (response) {
                    alert("회원가입을 축하드립니다!")
                    window.location.replace("/")
                }
            });
        }

        function isNickname(asValue) {
            var regExp = /^(?=.*[a-zA-Z])[-a-zA-Z0-9_.]{4,10}$/;
            return regExp.test(asValue);
        }

        function isEmail(asValue) {
            var regExp = regExp = /^[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_\.]?[0-9a-zA-Z])*\.[a-zA-Z]{2,3}$/i;
            return regExp.test(asValue);
        }

        function isPassword(asValue) {
            var regExp = /^(?=.*\d)(?=.*[a-zA-Z])[0-9a-zA-Z!@#$%^&*]{8,20}$/;
            return regExp.test(asValue);
        }

        function checkDupNicknameAndEmail() {
            let username = $("#username").val();
            let email = $("#email").val();
            $.ajax({
                type: "POST",
                url: "/sign_up/check_dup",
                async: false,
                data: {
                    username_give: username,
                    email_give: email
                },
                success: function (response) {
                    check = []
                    if (response["usernameExists"]) {
                        check.push(1)
                    } else {
                        check.push(0)
                    }
                    if (response["emailExists"]) {
                        check.push(1)
                    } else {
                        check.push(0)
                    }
                }
            });
        }
    </script>
</head>

<body>
<div class="container">
    <div class="d-flex justify-content-center h-100">
        <!-- 로그인 란 -->
        <div class="login-card" id="login">
            <div class="card-header">
                <h3>로그인</h3>
            </div>
            <!-- 간편로그인 아이콘
                            <div class="d-flex justify-content-end social_icon">
                                <span><i class="fab fa-facebook-square"></i></span>
                                <span><i class="fab fa-google-plus-square"></i></span>
                                <span><i class="fab fa-twitter-square"></i></span>
                            </div>
            -->
            <div class="card-body">
                <form>
                    <div class="input-group form-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-user"></i></span>
                        </div>
                        <input type="email" class="form-control" id="exampleFormControlInput1"
                               placeholder="이메일@helpmymenu.com">
                    </div>
                    <div class="input-group form-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-key"></i></span>
                        </div>
                        <input type="password" class="form-control" placeholder="패스워드">
                    </div>
                    <div class="row align-items-center remember">
                        <input type="checkbox">&nbsp;아이디 기억하기
                    </div>
                    <div class="form-group">
                        <input type="submit" value="로그인하기" class="btn float-right login_btn">
                    </div>
                </form>
            </div>
            <div class="card-footer">
                <div class="d-flex justify-content-center links">
                    아직 계정이 없으신가요?<a href="#" onclick="toggleSignUpAndIn()">회원가입 하러가기</a>
                </div>
            </div>
        </div>

        <!-- 회원가입 란 -->
        <div class="signup-card is-hidden" id="signup">
            <div class="card-header">
                <h3>회원가입</h3>
            </div>
            <div class="card-body">
                <form>
                    <div class="input-group form-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-user"></i></span>
                        </div>
                        <input type="text" class="form-control" id="username" minlength="4" maxlength="15"
                               placeholder="닉네임 (최소 4글자)" required>
                    </div>
                    <div class="input-group form-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                        </div>
                        <input type="email" class="form-control" id="email" placeholder="이메일@helpmymenu.com" required>
                    </div>
                    <div class="input-group form-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-key"></i></span>
                        </div>
                        <input type="password" class="form-control" id="password" minlength="8"
                               placeholder="패스워드 (최소 8글자)" required>
                    </div>
                    <div class="input-group form-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-key"></i></span>
                        </div>
                        <input type="password" class="form-control" id="repassword" minlength="8" length="8"
                               placeholder="패스워드를 재입력해주세요." required>
                    </div>
                    <div class="form-group">
                        <input type="button" value="가입하기" class="btn float-right login_btn" onclick="signUp()">
                    </div>
                </form>
            </div>
            <div class="card-footer">
                <div class="d-flex justify-content-center links">
                    회원가입 완료!<a href="#" onclick="toggleSignUpAndIn()">로그인 하러가기</a>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>